<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width">
		<title>The Ancient Temple</title>
		<link href="stylesheets/main_index_styles.css" rel="stylesheet" type="text/css">
		<style>
			body,p,span,div,input,label,img,h4,html,head,dialog,dialog::backdrop {
				cursor:url("sprites/icons/custom_pointer.png") 15 0, auto;
			}
			.mute_unchecked {
				background : url("sprites/icons/unmuted_icon.svg");
			}
			.mute_checked {
				background : url("sprites/icons/muted_icon.svg");
			}
			#prev_char_btn {
				margin : 0;
				border : none; 
				position : absolute;
				left : 0vw;
				top : 0%;
				height : 25%;
			}
			#next_char_btn {
				margin : 0;
				border : none;
				position : absolute;
				right : 0vw;
				top : 0%;
				height : 25%;
			}
			#char_select_btn {
				position : relative;
				left : 38.225%;
			}
			.csb {
				outline-style : none;
			}
			#char_preview {
				margin : 0;
				border-width : 1%;
				border : solid lightGrey;
				background : var(--bc);
				position : relative;
				width : 10vw;
				left : 38%;
				top : 0%;
			}
			#char_description {
				color : black;
				font-family : monospace;
				overflow-y : scroll;
				overflow-wrap : break-word;
			}
            /* a {
                cursor : url("custom-pointer.png"),default;
             } */
             :root {
				--bi_h : -288px;
				--bi_w : 32px;
			}
			.ts_im {
				position : absolute;
				height : 200vh;
				width : var(--width,200vw);
				left : 0%;
				top : 0%;
				animation : v_scroll 20s infinite linear;
				//z-index : 45;
			}
			@keyframes v_scroll {
				0% {
					transform : translate(var(--start_x,0%), var(--start_y,-5vh));
				}
				100% {
					transform : translate(var(--end_x,0%), var(--end_y,-100vh));
				}
			}
			#title_img {
				position : absolute;
				width : 40vw;
				left : 30%;
        		top : 40%;
				//z-index : /*50*/1;
			}
			#title_div {
				position : absolute;
				left : 0%;
				top : 0%;
				z-index : 10;
				overflow : hidden;
			}
		</style>
	</head>
	<body>
		<!-- cross window messaging script -->
		<script src="messages/index_messages.js"></script>
		<!-- all iframes -->
		<iframe id="loading_screen" src="./loading.html" sandbox="allow-same-origin allow-scripts" style="z-index:15;"></iframe>
		<div id="title_div" style="width:100vw;height:100vh;">
			<audio id="title_music" src="audios/titlescreenmusic.mp3" loop></audio>
			
			<div class="ts_im" style="--start_x:0%;--end_x:0%;--start_y:0%;--end_y:var(--bi_h);background : url(sprites/wall_1.png) repeat;" hidden></div>
			<div class="ts_im" style="--start_x:0%;--end_x:0%;--start_y:0%;--end_y:var(--bi_h);background : url(sprites/wall_2.png) repeat;" hidden></div>
			<img src="sprites/titlescreen.png" id="title_img">
			<div id="title_cover" style="background:black;width:100vw;height:100vh;position:absolute;left:0px;top:0px;"></div>
			<script>
				let in_title = true;
				let music_loaded = false;
				function close_title_screen (e) {
					if (document.getElementById("title_div").hidden) {
						return;
					}
					console.log("close", music_loaded);
					// doesn't close if the music isn't loaded, this is because of a glitch where if the music isn't loaded before the title screen is closed then it won't ever stop playing
					if (!music_loaded) {
						return;
					}
					// hides itself and stops the music
					document.getElementById("title_music").pause();
					document.getElementById("title_div").hidden = true;
					// focuses the cursor on the text input
					document.getElementById("text_input").focus();
					document.getElementById("text_input").value = "";
					in_title = false;
				}
				// picks the background
				const index = 1 + Math.round(Math.random());
				// starts the title screen music
				function start_title_music () {
					// only starts if it is fully loaded
					if (!document.getElementById("loading_screen").hidden || !in_title) {
						return;
					}
					document.getElementById("title_music").play();
					document.getElementById("title_cover").hidden = true;
					music_loaded = true;
				}
				// sets up the event listener
				document.getElementById("title_music").addEventListener("canplaythrough",function () {start_title_music()});
				// shows the correct background
				document.getElementById("title_div").children[index].hidden = false;
			</script>
		</div>
		<iframe id="combat_screen" src="./combat.html" sandbox="allow-same-origin allow-scripts" style="z-index:5;"></iframe>
		<iframe id="shop_screen" src="./shop.html" sandbox="allow-same-origin allow-scripts" style="z-index:5;"></iframe>
		<iframe id="equip_screen" src="./equip.html" sandbox="allow-same-origin allow-scripts" style="z-index:5;"></iframe>
		<input type="button" value="test equip" style="position:absolute;left:0%;top:0%;" onclick="document.getElementById('equip_screen').hidden=false">
		<!-- displays the selected character's icon in the lower right -->
    	<img id="char_display" src="" style="position:absolute;right:15%;bottom:0%;width:37vmin">
        <!--<yeet id="megayeet" style="maximumyeet"></yeet>-->
		<!-- coins and stats -->
		<img id="coin_icon" src="sprites/icons/coin_2_electric_boogaloo.png" style="width:8%;position:absolute;right:3%;top:11%">
		<label id="coin_count" for="coin_icon" style="font-family:monospace;color:yellow;position:absolute;right:11%;top:15%;">0</label>
		<p id="stats" style="font-size:3vh;position:absolute;left:2%;bottom:3%;">ATK: <span id="att_stat" style="color:crimson;">1/10</span><br>DEF: <span id="def_stat" style="color:aquamarine;width:100px;">1/10</span><br> CHA: <span id="per_stat" style="color:violet;">1/10</span><br><br><br>HEALTH: <span id="health_stat" style="color:springGreen;">20/20</span><br>SHIELD: <span id="shield_stat" style="color:cyan;">0</span></p>
		<!-- all audio elements -->
		<div>
			<audio id="boss_theme_1" src="audios/bossfight.mp3" loop></audio>
			<audio id="stage_3" src="audios/adventuremusic.mp3" loop volume="0.1"></audio>
			<audio id="namey" src="audios/namey.mp3" loop></audio>
			<audio id="silence" src="audios/silence.mp3" loop></audio>
			<audio id="youwin" src="audios/sfx/youwin.mp3"></audio>
			<audio id="adventure2" src="audios/adventure2.mp3" loop></audio>
			<audio id="adventure3" src="audios/adventure3.mp3" loop></audio>
            <audio id="battle" src="audios/battle.mp3" loop></audio>
			<audio id="shop" src="audios/shop.mp3" loop></audio>
			<audio id="equip" src="audios/equip.mp3" loop></audio>
            <!--<audio id="attack" src="audios/sfx/slash.wav"></audio>-->
		</div>
		<!-- all sound credits -->
		<dialog id="sound_credits">
			<p class="black">Sound Credits:<br>4 music tracks:<br>sawsquarenoise - Song Name(s)<br> - Stage 3<br> - Boss Battle<br> - Stage 1<br> - Stage 2<br> - not commercially used<br> - fade out at end of Stage 3 was cropped<br> - License here:<br><a href="https://creativecommons.org/licenses/by/4.0/legalcode" target="_blank">https://creativecommons.org/licenses/by/4.0/legalcode</a><br><br>1 music track:<br>Eric Skiff - Song Name<br> - Behind the waterfall lies the beginning<br> - Available at <a href="http://EricSkiff.com/music" target="_blank">http://EricSkiff.com/music</a><br><br>1 music track:<br>Derris-Kharlan - Song Name<br>- Prism Stars<br>- License here:<br><a href="https://creativecommons.org/licenses/by-nc-nd/3.0/https://creativecommons.org/licenses/by-nc-nd/3.0/"
            target="_blank">https://creativecommons.org/licenses/by-nc-nd/3.0/https://creativecommons.org/licenses/by-nc-nd/3.0/</a><br><br>2 music tracks:<br>Damiano Baldoni - Song Name(s)<br> - sport.mp3<br> - Chillout Loop.mp3<br> - not commercially used<br> - License here:<br><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/legalcode" target="_blank">https://creativecommons.org/licenses/by-nc-nd/4.0/legalcode</a><br><br></p>
			<br>
			<input type="button" class="wb" value="back" onclick="document.getElementById('sound_credits').close()">
		</dialog>
		<!-- most of the credits -->
		<dialog id="main_credits">
			<p class="black">Major Programming:<br>@tristans2<br><br>Major Graphic Design:<br>@JohnHalvorson<br><br>Story:<br>@JohnHalvorson<br><br>Playtesting:<br>@KaiWilhelm<br>@KaiJusuf</p>
			<input class="wb" type="button" value="sounds" onclick="document.getElementById('sound_credits').showModal()">
			<br>
			<input class="wb" type="button" value="back" onclick="document.getElementById('main_credits').close()">
		</dialog>
		<!-- main menu -->
		<dialog id="main_menu">
			<label for="toggle_sounds" class="black">mute sounds:</label>
			<input type="checkbox" onchange="toggleAudio()">
			<br>
            <label></label>
            <br> 
			<input class="wb" type="button" value="credits" onclick="document.getElementById('main_credits').showModal()">
			<br>
			<input class="wb" type="button" value="close" onclick="document.getElementById('main_menu').close()">
		</dialog>
		<!--menu button-->
		<input class="bb" type="button" id="menu_button" value="menu" onclick="document.getElementById('main_menu').showModal();" style="position:absolute;right:0%;bottom:30%;">
		<h4 id="header_text">TUTORIAL</h4>
		<p id="name_text"></p>
		<div id="main_text_container">
			<p id="main_output" class="output_line">Welcome to The Ancient Temple! </p>
			<div id="input_container">
				<p id="options"></p>
				<label for="text_input" id="prompt_label">Enter your name: </label>
				<input type="text" autocomplete="off" id="text_input" value="">
			</div>
		</div>
		<!-- character select screen -->
		<dialog id="char_select">
			<img src="sprites/icons/left_button_1.svg" id="prev_char_btn" class="csb" onclick="p_char()">
			<img id="char_preview" src="sprites/chars/character.png" alt="a preview image of the character">
			<img src="sprites/icons/right_button_1.svg" id="next_char_btn" class="csb" onclick="n_char()">
			<br>
			<input type="button" id="char_select_btn" class="wb" value="select" onclick="s_char()">
			<div id="char_description"></div>
		</dialog>
		<!-- holds the minimap -->
		<div id="minimap_div">
			<img id="context_img" src="" style="z-index:1;">
		</div>
		<!-- more accessable mute button -->
		<div id="mute_sounds_2" class="mute_unchecked"></div>
		<!-- all of the scripts used to run the game -->
		<div>
			<!-- used to do any setup that is required -->
			<script src="setup.js"></script>
			<script src="extra/independance.js"></script>
			<!-- the above script is just an easter egg -->
			<script src="chapter_1/option.js"></script>
			<script src="chapter_1/temple.js"></script>
			<script src="chapter_2/labyrinth1.js"></script>
			<!-- the above scripts hold the data for the story -->
			<script src="char_data.js"></script>
			<script src="chars.js"></script>
			<!-- the above scripts contain character data and a function to update the display to reflect stats -->
			<script src="interactions/loot.js"></script>
			<script src="interactions/equip.js"></script>
			<script src="interactions/combat.js"></script>
			<script src="interactions/shop.js"></script>
			<!-- above scripts handle interactions -->
			<!-- main script -->
			<script src="script.js"></script>
			<!-- does the minimap -->
			<script src="mini.js"></script>
		</div>
	</body>
</html>